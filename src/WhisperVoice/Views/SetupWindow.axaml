<Window xmlns="https://github.com/avaloniaui"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:vm="using:WhisperVoice.ViewModels"
        xmlns:models="using:WhisperVoice.Models"
        x:Class="WhisperVoice.Views.SetupWindow"
        x:DataType="vm:SetupViewModel"
        Title="Whisper Voice Setup"
        Width="560" Height="580"
        WindowStartupLocation="CenterScreen"
        CanResize="False"
        ExtendClientAreaToDecorationsHint="True"
        ExtendClientAreaChromeHints="NoChrome"
        Background="{DynamicResource BgPrimary}">

    <Window.Styles>
        <!-- Base text -->
        <Style Selector="TextBlock">
            <Setter Property="Foreground" Value="{DynamicResource TextPrimary}"/>
        </Style>

        <!-- ListBox -->
        <Style Selector="ListBox">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="BorderThickness" Value="0"/>
        </Style>
        <Style Selector="ListBoxItem">
            <Setter Property="Background" Value="Transparent"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="Padding" Value="12,10"/>
            <Setter Property="Margin" Value="0,2"/>
        </Style>
        <Style Selector="ListBoxItem:selected /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource BgAccent}"/>
        </Style>
        <Style Selector="ListBoxItem:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource BgSecondary}"/>
        </Style>

        <!-- Progress bar -->
        <Style Selector="ProgressBar">
            <Setter Property="Background" Value="{DynamicResource BgTertiary}"/>
            <Setter Property="Foreground" Value="{DynamicResource BgAccent}"/>
            <Setter Property="CornerRadius" Value="3"/>
        </Style>

        <!-- Primary button -->
        <Style Selector="Button.primary">
            <Setter Property="Background" Value="{DynamicResource BgAccent}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextWhite}"/>
            <Setter Property="Padding" Value="24,10"/>
            <Setter Property="CornerRadius" Value="8"/>
            <Setter Property="BorderThickness" Value="0"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Cursor" Value="Hand"/>
        </Style>
        <Style Selector="Button.primary:pointerover /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource BgAccentHover}"/>
        </Style>
        <Style Selector="Button.primary:disabled /template/ ContentPresenter">
            <Setter Property="Background" Value="{DynamicResource BgAccentDim}"/>
            <Setter Property="Foreground" Value="{DynamicResource TextDim}"/>
        </Style>
    </Window.Styles>

    <Grid RowDefinitions="32,*">
        <!-- Titlebar (draggable) -->
        <Border Grid.Row="0" Background="{DynamicResource BgTertiary}" Name="TitleBar"/>

        <!-- Content -->
        <Border Grid.Row="1" Margin="40,8,40,32">
            <StackPanel Spacing="20" VerticalAlignment="Center">
                <!-- Title -->
                <StackPanel Spacing="4" HorizontalAlignment="Center">
                    <TextBlock Text="Welcome to Whisper Voice"
                               FontSize="24" FontWeight="Bold" Foreground="{DynamicResource TextWhite}"
                               HorizontalAlignment="Center"/>
                    <TextBlock Text="Choose a speech recognition model to get started"
                               Foreground="{DynamicResource TextMuted}" FontSize="13"
                               HorizontalAlignment="Center"/>
                </StackPanel>

                <!-- Model selection list -->
                <ListBox ItemsSource="{Binding AvailableModels}"
                         SelectedItem="{Binding SelectedModel}"
                         MaxHeight="320">
                    <ListBox.ItemTemplate>
                        <DataTemplate x:DataType="models:WhisperModelInfo">
                            <Grid ColumnDefinitions="*,Auto,Auto,Auto,Auto">
                                <TextBlock Grid.Column="0" Text="{Binding DisplayName}"
                                           FontWeight="SemiBold" Foreground="{DynamicResource TextWhite}"
                                           VerticalAlignment="Center"/>
                                <Border Grid.Column="1" Background="{DynamicResource BgOverlay}" CornerRadius="4"
                                        Padding="8,2" Margin="8,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding ApproxSize}" Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
                                </Border>
                                <Border Grid.Column="2" Background="{DynamicResource BgOverlay}" CornerRadius="4"
                                        Padding="8,2" Margin="4,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding VramRequired, StringFormat='VRAM: {0}'}" Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
                                </Border>
                                <Border Grid.Column="3" Background="{DynamicResource BgOverlay}" CornerRadius="4"
                                        Padding="8,2" Margin="4,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Speed}" Foreground="{DynamicResource TextSecondary}" FontSize="11"/>
                                </Border>
                                <Border Grid.Column="4" Background="{DynamicResource BgAccentTint}" CornerRadius="4"
                                        Padding="8,2" Margin="4,0" VerticalAlignment="Center">
                                    <TextBlock Text="{Binding Quality}" Foreground="{DynamicResource AccentCyan}" FontSize="11" FontWeight="SemiBold"/>
                                </Border>
                            </Grid>
                        </DataTemplate>
                    </ListBox.ItemTemplate>
                </ListBox>

                <!-- Download progress -->
                <ProgressBar IsIndeterminate="True"
                             IsVisible="{Binding IsDownloading}"
                             Height="6"/>

                <!-- Status text -->
                <TextBlock Text="{Binding StatusText}"
                           Foreground="{DynamicResource TextMuted}" HorizontalAlignment="Center" FontSize="12"/>

                <!-- Download button -->
                <Button Classes="primary"
                        Content="Download and Continue"
                        Command="{Binding DownloadAndContinueCommand}"
                        HorizontalAlignment="Center"/>
            </StackPanel>
        </Border>
    </Grid>
</Window>
